# ---------------------------------------------------------------------------------------------
# MIT License
# Copyright (c) 2020, Solace Corporation, Ricardo Gomez-Ulmke (ricardo.gomez-ulmke@solace.com)
# ---------------------------------------------------------------------------------------------

# cloud_provider + infrastructure_id - required
# add fanout ratio?
#  - yes
#  - dynamic publiser assignment to vms
#  - calculate number of consumers per consumer vm that was provisioned
# run tests in parallel on all infrastructures?
# - should organize runs by infrastructure id?

    # matrix concept:
    #   - infrastructure-id:
    #     - {cloud-provider}.{config-id}
    #   - for infrastructures
    #     - cloud-provider: azure, aws
    #     - config-id: infra1-standalone, infra2-standalone

    #   strategy:
    #     fail-fast: true
    #     matrix:
    #       cloud_provider_id: [azure, aws]
    #       config_id: [infra1-standalone, infra2-standalone]

---
  test_spec:
    name: 1_test
    use_case: uc_non_persistent
    infrastructure_list:
      - cloud_provider: azure
        config: test1-standalone
      # - cloud_provider: aws
      #   config: test1-standalone
    run_specs:
      run_params:
        total_num_samples: 3
        sample_duration_secs: 60
      run_defaults:
        load:
          include: true
        monitors:
          # only 1 latency for both ==> otherwise, what's the point
          latency:
            include: true
            topic_prefix: "private/direct/latency" # out
            warmup_secs: 10 # out
            msg_rate_per_second: 1000 # define a max of 10000
            msg_payload_size_bytes: 100 # define a max of 10K
            lg: 15 # out
            lb: 4096 # out
            lpm: true
          latency_brokernode:
            include: true
            topic_prefix: "private/direct/latency-brokernode"
            warmup_secs: 10
            msg_rate_per_second: 1000 # 0=max
            msg_payload_size_bytes: 100 # 100 || 1000 || 10000 || etc...
            lg: 15
            lb: 4096
            lpm: true
          ping:
            include: true
          vpn_stats:
            include: true
      runs:
        # - name: 0_variation
        - name: 1_variation
          load:
            include: false
          monitors:
            latency:
              include: false
            latency_brokernode:
              include: false
            vpn_stats:
              include: false
            ping:
              include: true
        # - name: 2_variation
        #   load:
        #     include: false
        #   monitors:
        #     latency:
        #       include: false
        #     latency_brokernode:
        #       include: false
        #     vpn_stats:
        #       include: false
        #     ping:
        #       include: true

###
# The End.
